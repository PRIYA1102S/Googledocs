{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useEffect, useRef } from 'react';\nimport { io } from 'socket.io-client';\nconst useSocket = (documentId, userId, userName) => {\n  _s();\n  const socketRef = useRef(null);\n  useEffect(() => {\n    if (!documentId || !userId || !userName) return;\n\n    // Initialize socket connection\n    socketRef.current = io('http://localhost:5001', {\n      withCredentials: true\n    });\n    const socket = socketRef.current;\n\n    // Join the document room\n    console.log('Joining document room:', {\n      documentId,\n      userId,\n      userName\n    });\n    socket.emit('join-document', {\n      documentId,\n      userId,\n      userName\n    });\n\n    // Cleanup on unmount\n    return () => {\n      if (socket) {\n        socket.disconnect();\n        socketRef.current = null;\n      }\n    };\n  }, [documentId, userId, userName]);\n  const emitDocumentChange = (delta, content) => {\n    if (socketRef.current) {\n      console.log('Emitting document change:', {\n        documentId,\n        delta,\n        content\n      });\n      socketRef.current.emit('document-change', {\n        documentId,\n        delta,\n        content\n      });\n    }\n  };\n  const emitCursorChange = (position, selection) => {\n    if (socketRef.current) {\n      socketRef.current.emit('cursor-change', {\n        documentId,\n        position,\n        selection\n      });\n    }\n  };\n  const onDocumentChange = callback => {\n    if (socketRef.current) {\n      socketRef.current.on('document-changed', callback);\n    }\n  };\n  const onCursorChange = callback => {\n    if (socketRef.current) {\n      socketRef.current.on('cursor-changed', callback);\n    }\n  };\n  const onUserJoined = callback => {\n    if (socketRef.current) {\n      socketRef.current.on('user-joined', callback);\n    }\n  };\n  const onUserLeft = callback => {\n    if (socketRef.current) {\n      socketRef.current.on('user-left', callback);\n    }\n  };\n  const onUsersInDocument = callback => {\n    if (socketRef.current) {\n      socketRef.current.on('users-in-document', callback);\n    }\n  };\n  const offDocumentChange = () => {\n    if (socketRef.current) {\n      socketRef.current.off('document-changed');\n    }\n  };\n  const offCursorChange = () => {\n    if (socketRef.current) {\n      socketRef.current.off('cursor-changed');\n    }\n  };\n  const offUserJoined = () => {\n    if (socketRef.current) {\n      socketRef.current.off('user-joined');\n    }\n  };\n  const offUserLeft = () => {\n    if (socketRef.current) {\n      socketRef.current.off('user-left');\n    }\n  };\n  const offUsersInDocument = () => {\n    if (socketRef.current) {\n      socketRef.current.off('users-in-document');\n    }\n  };\n  return {\n    socket: socketRef.current,\n    emitDocumentChange,\n    emitCursorChange,\n    onDocumentChange,\n    onCursorChange,\n    onUserJoined,\n    onUserLeft,\n    onUsersInDocument,\n    offDocumentChange,\n    offCursorChange,\n    offUserJoined,\n    offUserLeft,\n    offUsersInDocument\n  };\n};\n_s(useSocket, \"8c0rAI93JE8jpOVTnobt43KkFfY=\");\nexport default useSocket;","map":{"version":3,"names":["useEffect","useRef","io","useSocket","documentId","userId","userName","_s","socketRef","current","withCredentials","socket","console","log","emit","disconnect","emitDocumentChange","delta","content","emitCursorChange","position","selection","onDocumentChange","callback","on","onCursorChange","onUserJoined","onUserLeft","onUsersInDocument","offDocumentChange","off","offCursorChange","offUserJoined","offUserLeft","offUsersInDocument"],"sources":["D:/Docs-MERN/google-docs-clone/frontend/src/hooks/useSocket.js"],"sourcesContent":["import { useEffect, useRef } from 'react';\r\nimport { io } from 'socket.io-client';\r\n\r\nconst useSocket = (documentId, userId, userName) => {\r\n  const socketRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    if (!documentId || !userId || !userName) return;\r\n\r\n    // Initialize socket connection\r\n    socketRef.current = io('http://localhost:5001', {\r\n      withCredentials: true,\r\n    });\r\n\r\n    const socket = socketRef.current;\r\n\r\n    // Join the document room\r\n    console.log('Joining document room:', { documentId, userId, userName });\r\n    socket.emit('join-document', {\r\n      documentId,\r\n      userId,\r\n      userName,\r\n    });\r\n\r\n    // Cleanup on unmount\r\n    return () => {\r\n      if (socket) {\r\n        socket.disconnect();\r\n        socketRef.current = null;\r\n      }\r\n    };\r\n  }, [documentId, userId, userName]);\r\n\r\n  const emitDocumentChange = (delta, content) => {\r\n    if (socketRef.current) {\r\n      console.log('Emitting document change:', { documentId, delta, content });\r\n      socketRef.current.emit('document-change', {\r\n        documentId,\r\n        delta,\r\n        content,\r\n      });\r\n    }\r\n  };\r\n\r\n  const emitCursorChange = (position, selection) => {\r\n    if (socketRef.current) {\r\n      socketRef.current.emit('cursor-change', {\r\n        documentId,\r\n        position,\r\n        selection,\r\n      });\r\n    }\r\n  };\r\n\r\n  const onDocumentChange = (callback) => {\r\n    if (socketRef.current) {\r\n      socketRef.current.on('document-changed', callback);\r\n    }\r\n  };\r\n\r\n  const onCursorChange = (callback) => {\r\n    if (socketRef.current) {\r\n      socketRef.current.on('cursor-changed', callback);\r\n    }\r\n  };\r\n\r\n  const onUserJoined = (callback) => {\r\n    if (socketRef.current) {\r\n      socketRef.current.on('user-joined', callback);\r\n    }\r\n  };\r\n\r\n  const onUserLeft = (callback) => {\r\n    if (socketRef.current) {\r\n      socketRef.current.on('user-left', callback);\r\n    }\r\n  };\r\n\r\n  const onUsersInDocument = (callback) => {\r\n    if (socketRef.current) {\r\n      socketRef.current.on('users-in-document', callback);\r\n    }\r\n  };\r\n\r\n  const offDocumentChange = () => {\r\n    if (socketRef.current) {\r\n      socketRef.current.off('document-changed');\r\n    }\r\n  };\r\n\r\n  const offCursorChange = () => {\r\n    if (socketRef.current) {\r\n      socketRef.current.off('cursor-changed');\r\n    }\r\n  };\r\n\r\n  const offUserJoined = () => {\r\n    if (socketRef.current) {\r\n      socketRef.current.off('user-joined');\r\n    }\r\n  };\r\n\r\n  const offUserLeft = () => {\r\n    if (socketRef.current) {\r\n      socketRef.current.off('user-left');\r\n    }\r\n  };\r\n\r\n  const offUsersInDocument = () => {\r\n    if (socketRef.current) {\r\n      socketRef.current.off('users-in-document');\r\n    }\r\n  };\r\n\r\n  return {\r\n    socket: socketRef.current,\r\n    emitDocumentChange,\r\n    emitCursorChange,\r\n    onDocumentChange,\r\n    onCursorChange,\r\n    onUserJoined,\r\n    onUserLeft,\r\n    onUsersInDocument,\r\n    offDocumentChange,\r\n    offCursorChange,\r\n    offUserJoined,\r\n    offUserLeft,\r\n    offUsersInDocument,\r\n  };\r\n};\r\n\r\nexport default useSocket;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}