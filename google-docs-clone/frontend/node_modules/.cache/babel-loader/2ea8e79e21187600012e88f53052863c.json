{"ast":null,"code":"var _jsxFileName = \"D:\\\\Docs-MERN\\\\google-docs-clone\\\\frontend\\\\src\\\\components\\\\CollaborativeTextElement.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef, useCallback } from 'react';\nimport ReactQuill from 'react-quill';\nimport { useTheme } from '../contexts/ThemeContext';\nimport 'react-quill/dist/quill.snow.css';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst CollaborativeTextElement = ({\n  content,\n  onChange,\n  onSelectionChange,\n  isReadOnly = false,\n  remoteSelections = []\n}) => {\n  _s();\n  const [value, setValue] = useState(content);\n  const {\n    isDark\n  } = useTheme();\n  const quillRef = useRef(null);\n  const isRemoteChangeRef = useRef(false);\n  const lastChangeSourceRef = useRef('user');\n  const cursorPositionRef = useRef(null);\n  const isUserTypingRef = useRef(false);\n  const isInitializedRef = useRef(false);\n\n  // Initialize component with content\n  useEffect(() => {\n    if (!isInitializedRef.current && content) {\n      setValue(content);\n      isInitializedRef.current = true;\n    }\n  }, [content]);\n  useEffect(() => {\n    // Only update if content is actually different and not from user typing\n    if (content !== value && !isUserTypingRef.current && isInitializedRef.current) {\n      // Save current cursor position before updating\n      if (quillRef.current) {\n        const quill = quillRef.current.getEditor();\n        const selection = quill.getSelection();\n        if (selection) {\n          cursorPositionRef.current = {\n            index: selection.index,\n            length: selection.length\n          };\n        }\n      }\n      setValue(content);\n      isRemoteChangeRef.current = true;\n\n      // Restore cursor position after content update\n      setTimeout(() => {\n        if (quillRef.current && cursorPositionRef.current !== null) {\n          const quill = quillRef.current.getEditor();\n          const length = quill.getLength();\n          const position = Math.min(cursorPositionRef.current.index, length - 1);\n          const selectionLength = Math.min(cursorPositionRef.current.length, length - position);\n          quill.setSelection(position, selectionLength);\n          cursorPositionRef.current = null;\n        }\n      }, 0);\n    }\n  }, [content, value]);\n  const handleChange = useCallback((val, delta, source, editor) => {\n    if (source === 'user' && !isReadOnly) {\n      isUserTypingRef.current = true;\n      setValue(val);\n      if (onChange) {\n        onChange(val);\n      }\n\n      // Emit selection change for cursor tracking\n      if (onSelectionChange && quillRef.current) {\n        const quill = quillRef.current.getEditor();\n        const selection = quill.getSelection();\n        if (selection) {\n          onSelectionChange(selection);\n        }\n      }\n\n      // Reset the typing flag after a short delay\n      setTimeout(() => {\n        isUserTypingRef.current = false;\n      }, 150);\n    }\n  }, [onChange, onSelectionChange, isReadOnly]);\n  const handleSelectionChange = useCallback((range, source, editor) => {\n    if (source === 'user' && range && onSelectionChange) {\n      onSelectionChange(range);\n    }\n  }, [onSelectionChange]);\n\n  // Method to apply remote changes\n  const applyRemoteChange = useCallback(newContent => {\n    isRemoteChangeRef.current = true;\n    setValue(newContent);\n  }, []);\n\n  // Note: we no longer rely on imperative handle from parent; the component\n  // reacts to prop changes directly to display remote edits.\n\n  // Enhanced custom styles for dark mode\n  const customStyles = `\n        .ql-editor {\n            ${isDark ? 'color: #f1f5f9; background-color: #1e293b;' : 'color: #1e293b; background-color: #ffffff;'}\n            min-height: 200px;\n            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;\n            line-height: 1.6;\n        }\n        .ql-editor.ql-blank::before {\n            ${isDark ? 'color: #94a3b8;' : 'color: #9ca3af;'}\n            font-style: italic;\n        }\n        .ql-toolbar {\n            ${isDark ? 'background-color: #334155; border-color: #475569;' : 'background-color: #f8fafc; border-color: #e2e8f0;'}\n            border-top-left-radius: 8px;\n            border-top-right-radius: 8px;\n        }\n        .ql-container {\n            ${isDark ? 'border-color: #475569;' : 'border-color: #e2e8f0;'}\n            border-bottom-left-radius: 8px;\n            border-bottom-right-radius: 8px;\n        }\n        .ql-toolbar button {\n            ${isDark ? 'color: #e2e8f0;' : 'color: #475569;'}\n            transition: all 0.2s ease;\n        }\n        .ql-toolbar button:hover {\n            ${isDark ? 'color: #60a5fa; background-color: #475569;' : 'color: #3b82f6; background-color: #e2e8f0;'}\n            border-radius: 4px;\n        }\n        .ql-toolbar .ql-active {\n            ${isDark ? 'color: #60a5fa; background-color: #475569;' : 'color: #3b82f6; background-color: #dbeafe;'}\n            border-radius: 4px;\n        }\n        .ql-toolbar .ql-picker {\n            ${isDark ? 'color: #e2e8f0;' : 'color: #475569;'}\n        }\n        .ql-toolbar .ql-picker:hover {\n            ${isDark ? 'color: #60a5fa;' : 'color: #3b82f6;'}\n        }\n        .ql-toolbar .ql-picker-label {\n            ${isDark ? 'color: #e2e8f0;' : 'color: #475569;'}\n            transition: all 0.2s ease;\n        }\n        .ql-toolbar .ql-picker-label:hover {\n            ${isDark ? 'color: #60a5fa;' : 'color: #3b82f6;'}\n        }\n        .ql-toolbar .ql-picker-options {\n            ${isDark ? 'background-color: #475569; border-color: #64748b;' : 'background-color: #ffffff; border-color: #e2e8f0;'}\n            border-radius: 6px;\n            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);\n        }\n        .ql-toolbar .ql-picker-item {\n            ${isDark ? 'color: #e2e8f0;' : 'color: #475569;'}\n            transition: all 0.2s ease;\n        }\n        .ql-toolbar .ql-picker-item:hover {\n            ${isDark ? 'color: #60a5fa; background-color: #64748b;' : 'color: #3b82f6; background-color: #f1f5f9;'}\n        }\n        .ql-toolbar .ql-stroke {\n            ${isDark ? 'stroke: #e2e8f0;' : 'stroke: #475569;'}\n            transition: stroke 0.2s ease;\n        }\n        .ql-toolbar .ql-fill {\n            ${isDark ? 'fill: #e2e8f0;' : 'fill: #475569;'}\n            transition: fill 0.2s ease;\n        }\n        .ql-toolbar .ql-picker-label:hover .ql-stroke,\n        .ql-toolbar button:hover .ql-stroke {\n            ${isDark ? 'stroke: #60a5fa;' : 'stroke: #3b82f6;'}\n        }\n        .ql-toolbar .ql-picker-label:hover .ql-fill,\n        .ql-toolbar button:hover .ql-fill {\n            ${isDark ? 'fill: #60a5fa;' : 'fill: #3b82f6;'}\n        }\n        .ql-toolbar .ql-active .ql-stroke {\n            ${isDark ? 'stroke: #60a5fa;' : 'stroke: #3b82f6;'}\n        }\n        .ql-toolbar .ql-active .ql-fill {\n            ${isDark ? 'fill: #60a5fa;' : 'fill: #3b82f6;'}\n        }\n        \n        /* Collaborative cursor styles */\n        .ql-cursor {\n            position: absolute;\n            width: 2px;\n            background-color: #3b82f6;\n            z-index: 10;\n        }\n        .ql-cursor-name {\n            position: absolute;\n            top: -20px;\n            left: 0;\n            background-color: #3b82f6;\n            color: white;\n            padding: 2px 6px;\n            border-radius: 4px;\n            font-size: 12px;\n            white-space: nowrap;\n            z-index: 11;\n        }\n        \n        /* Selection highlight for other users */\n        .ql-selection {\n            background-color: rgba(59, 130, 246, 0.2);\n            position: absolute;\n            z-index: 5;\n        }\n        /* Overlay container */\n        .ql-remote-overlays {\n            position: relative;\n        }\n    `;\n  const modules = {\n    toolbar: [[{\n      'header': [1, 2, 3, false]\n    }], ['bold', 'italic', 'underline', 'strike'], [{\n      'color': []\n    }, {\n      'background': []\n    }], [{\n      'list': 'ordered'\n    }, {\n      'list': 'bullet'\n    }], [{\n      'indent': '-1'\n    }, {\n      'indent': '+1'\n    }], [{\n      'align': []\n    }], ['link', 'blockquote', 'code-block'], ['clean']]\n  };\n  const formats = ['header', 'bold', 'italic', 'underline', 'strike', 'color', 'background', 'list', 'bullet', 'indent', 'align', 'link', 'blockquote', 'code-block'];\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"style\", {\n      children: customStyles\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 230,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `${isDark ? 'bg-gray-800' : 'bg-white'} rounded-lg border ${isDark ? 'border-gray-700' : 'border-gray-200'} shadow-sm`,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ql-remote-overlays\",\n        style: {\n          position: 'relative'\n        },\n        children: [/*#__PURE__*/_jsxDEV(ReactQuill, {\n          ref: quillRef,\n          theme: \"snow\",\n          value: value,\n          onChange: handleChange,\n          onChangeSelection: handleSelectionChange,\n          modules: isReadOnly ? {\n            toolbar: false\n          } : modules,\n          formats: formats,\n          readOnly: isReadOnly,\n          placeholder: isReadOnly ? \"This document is read-only\" : \"Start typing your document...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 233,\n          columnNumber: 21\n        }, this), quillRef.current && remoteSelections && remoteSelections.map(sel => {\n          try {\n            const quill = quillRef.current.getEditor();\n            const bounds = quill.getBounds(sel.index, sel.length || 0);\n            const container = quill.getBounds(0, quill.getLength());\n            if (!bounds) return null;\n            const cursorStyle = {\n              position: 'absolute',\n              left: `${bounds.left}px`,\n              top: `${bounds.top}px`,\n              height: `${bounds.height || 18}px`,\n              width: '2px',\n              backgroundColor: sel.color,\n              zIndex: 10\n            };\n            const nameStyle = {\n              position: 'absolute',\n              left: `${bounds.left}px`,\n              top: `${Math.max(bounds.top - 20, 0)}px`,\n              backgroundColor: sel.color,\n              color: '#fff',\n              padding: '2px 6px',\n              borderRadius: '4px',\n              fontSize: '12px',\n              whiteSpace: 'nowrap',\n              zIndex: 11\n            };\n            const selectionStyle = sel.length > 0 ? {\n              position: 'absolute',\n              left: `${bounds.left}px`,\n              top: `${bounds.top}px`,\n              width: `${bounds.width || 2}px`,\n              height: `${bounds.height || 18}px`,\n              backgroundColor: `${sel.color}33`,\n              // ~20% opacity\n              zIndex: 5\n            } : null;\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [selectionStyle && /*#__PURE__*/_jsxDEV(\"div\", {\n                style: selectionStyle\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 288,\n                columnNumber: 56\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                style: cursorStyle\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 289,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                style: nameStyle,\n                children: sel.name || 'User'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 290,\n                columnNumber: 37\n              }, this)]\n            }, sel.userId, true, {\n              fileName: _jsxFileName,\n              lineNumber: 287,\n              columnNumber: 33\n            }, this);\n          } catch (e) {\n            return null;\n          }\n        })]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 231,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true);\n};\n_s(CollaborativeTextElement, \"jnXJsJil5ZDL5HY8plBguo++Ujg=\", false, function () {\n  return [useTheme];\n});\n_c = CollaborativeTextElement;\nexport default CollaborativeTextElement;\nvar _c;\n$RefreshReg$(_c, \"CollaborativeTextElement\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useCallback","ReactQuill","useTheme","jsxDEV","_jsxDEV","Fragment","_Fragment","CollaborativeTextElement","content","onChange","onSelectionChange","isReadOnly","remoteSelections","_s","value","setValue","isDark","quillRef","isRemoteChangeRef","lastChangeSourceRef","cursorPositionRef","isUserTypingRef","isInitializedRef","current","quill","getEditor","selection","getSelection","index","length","setTimeout","getLength","position","Math","min","selectionLength","setSelection","handleChange","val","delta","source","editor","handleSelectionChange","range","applyRemoteChange","newContent","customStyles","modules","toolbar","formats","children","fileName","_jsxFileName","lineNumber","columnNumber","className","style","ref","theme","onChangeSelection","readOnly","placeholder","map","sel","bounds","getBounds","container","cursorStyle","left","top","height","width","backgroundColor","color","zIndex","nameStyle","max","padding","borderRadius","fontSize","whiteSpace","selectionStyle","name","userId","e","_c","$RefreshReg$"],"sources":["D:/Docs-MERN/google-docs-clone/frontend/src/components/CollaborativeTextElement.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef, useCallback } from 'react';\r\nimport ReactQuill from 'react-quill';\r\nimport { useTheme } from '../contexts/ThemeContext';\r\nimport 'react-quill/dist/quill.snow.css';\r\n\r\nconst CollaborativeTextElement = ({ content, onChange, onSelectionChange, isReadOnly = false, remoteSelections = [] }) => {\r\n    const [value, setValue] = useState(content);\r\n    const { isDark } = useTheme();\r\n    const quillRef = useRef(null);\r\n    const isRemoteChangeRef = useRef(false);\r\n    const lastChangeSourceRef = useRef('user');\r\n    const cursorPositionRef = useRef(null);\r\n    const isUserTypingRef = useRef(false);\r\n    const isInitializedRef = useRef(false);\r\n\r\n    // Initialize component with content\r\n    useEffect(() => {\r\n        if (!isInitializedRef.current && content) {\r\n            setValue(content);\r\n            isInitializedRef.current = true;\r\n        }\r\n    }, [content]);\r\n\r\n    useEffect(() => {\r\n        // Only update if content is actually different and not from user typing\r\n        if (content !== value && !isUserTypingRef.current && isInitializedRef.current) {\r\n            // Save current cursor position before updating\r\n            if (quillRef.current) {\r\n                const quill = quillRef.current.getEditor();\r\n                const selection = quill.getSelection();\r\n                if (selection) {\r\n                    cursorPositionRef.current = {\r\n                        index: selection.index,\r\n                        length: selection.length\r\n                    };\r\n                }\r\n            }\r\n            \r\n            setValue(content);\r\n            isRemoteChangeRef.current = true;\r\n            \r\n            // Restore cursor position after content update\r\n            setTimeout(() => {\r\n                if (quillRef.current && cursorPositionRef.current !== null) {\r\n                    const quill = quillRef.current.getEditor();\r\n                    const length = quill.getLength();\r\n                    const position = Math.min(cursorPositionRef.current.index, length - 1);\r\n                    const selectionLength = Math.min(cursorPositionRef.current.length, length - position);\r\n                    quill.setSelection(position, selectionLength);\r\n                    cursorPositionRef.current = null;\r\n                }\r\n            }, 0);\r\n        }\r\n    }, [content, value]);\r\n\r\n    const handleChange = useCallback((val, delta, source, editor) => {\r\n        if (source === 'user' && !isReadOnly) {\r\n            isUserTypingRef.current = true;\r\n            setValue(val);\r\n            if (onChange) {\r\n                onChange(val);\r\n            }\r\n            \r\n            // Emit selection change for cursor tracking\r\n            if (onSelectionChange && quillRef.current) {\r\n                const quill = quillRef.current.getEditor();\r\n                const selection = quill.getSelection();\r\n                if (selection) {\r\n                    onSelectionChange(selection);\r\n                }\r\n            }\r\n            \r\n            // Reset the typing flag after a short delay\r\n            setTimeout(() => {\r\n                isUserTypingRef.current = false;\r\n            }, 150);\r\n        }\r\n    }, [onChange, onSelectionChange, isReadOnly]);\r\n\r\n    const handleSelectionChange = useCallback((range, source, editor) => {\r\n        if (source === 'user' && range && onSelectionChange) {\r\n            onSelectionChange(range);\r\n        }\r\n    }, [onSelectionChange]);\r\n\r\n    // Method to apply remote changes\r\n    const applyRemoteChange = useCallback((newContent) => {\r\n        isRemoteChangeRef.current = true;\r\n        setValue(newContent);\r\n    }, []);\r\n\r\n    // Note: we no longer rely on imperative handle from parent; the component\r\n    // reacts to prop changes directly to display remote edits.\r\n\r\n    // Enhanced custom styles for dark mode\r\n    const customStyles = `\r\n        .ql-editor {\r\n            ${isDark ? 'color: #f1f5f9; background-color: #1e293b;' : 'color: #1e293b; background-color: #ffffff;'}\r\n            min-height: 200px;\r\n            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;\r\n            line-height: 1.6;\r\n        }\r\n        .ql-editor.ql-blank::before {\r\n            ${isDark ? 'color: #94a3b8;' : 'color: #9ca3af;'}\r\n            font-style: italic;\r\n        }\r\n        .ql-toolbar {\r\n            ${isDark ? 'background-color: #334155; border-color: #475569;' : 'background-color: #f8fafc; border-color: #e2e8f0;'}\r\n            border-top-left-radius: 8px;\r\n            border-top-right-radius: 8px;\r\n        }\r\n        .ql-container {\r\n            ${isDark ? 'border-color: #475569;' : 'border-color: #e2e8f0;'}\r\n            border-bottom-left-radius: 8px;\r\n            border-bottom-right-radius: 8px;\r\n        }\r\n        .ql-toolbar button {\r\n            ${isDark ? 'color: #e2e8f0;' : 'color: #475569;'}\r\n            transition: all 0.2s ease;\r\n        }\r\n        .ql-toolbar button:hover {\r\n            ${isDark ? 'color: #60a5fa; background-color: #475569;' : 'color: #3b82f6; background-color: #e2e8f0;'}\r\n            border-radius: 4px;\r\n        }\r\n        .ql-toolbar .ql-active {\r\n            ${isDark ? 'color: #60a5fa; background-color: #475569;' : 'color: #3b82f6; background-color: #dbeafe;'}\r\n            border-radius: 4px;\r\n        }\r\n        .ql-toolbar .ql-picker {\r\n            ${isDark ? 'color: #e2e8f0;' : 'color: #475569;'}\r\n        }\r\n        .ql-toolbar .ql-picker:hover {\r\n            ${isDark ? 'color: #60a5fa;' : 'color: #3b82f6;'}\r\n        }\r\n        .ql-toolbar .ql-picker-label {\r\n            ${isDark ? 'color: #e2e8f0;' : 'color: #475569;'}\r\n            transition: all 0.2s ease;\r\n        }\r\n        .ql-toolbar .ql-picker-label:hover {\r\n            ${isDark ? 'color: #60a5fa;' : 'color: #3b82f6;'}\r\n        }\r\n        .ql-toolbar .ql-picker-options {\r\n            ${isDark ? 'background-color: #475569; border-color: #64748b;' : 'background-color: #ffffff; border-color: #e2e8f0;'}\r\n            border-radius: 6px;\r\n            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);\r\n        }\r\n        .ql-toolbar .ql-picker-item {\r\n            ${isDark ? 'color: #e2e8f0;' : 'color: #475569;'}\r\n            transition: all 0.2s ease;\r\n        }\r\n        .ql-toolbar .ql-picker-item:hover {\r\n            ${isDark ? 'color: #60a5fa; background-color: #64748b;' : 'color: #3b82f6; background-color: #f1f5f9;'}\r\n        }\r\n        .ql-toolbar .ql-stroke {\r\n            ${isDark ? 'stroke: #e2e8f0;' : 'stroke: #475569;'}\r\n            transition: stroke 0.2s ease;\r\n        }\r\n        .ql-toolbar .ql-fill {\r\n            ${isDark ? 'fill: #e2e8f0;' : 'fill: #475569;'}\r\n            transition: fill 0.2s ease;\r\n        }\r\n        .ql-toolbar .ql-picker-label:hover .ql-stroke,\r\n        .ql-toolbar button:hover .ql-stroke {\r\n            ${isDark ? 'stroke: #60a5fa;' : 'stroke: #3b82f6;'}\r\n        }\r\n        .ql-toolbar .ql-picker-label:hover .ql-fill,\r\n        .ql-toolbar button:hover .ql-fill {\r\n            ${isDark ? 'fill: #60a5fa;' : 'fill: #3b82f6;'}\r\n        }\r\n        .ql-toolbar .ql-active .ql-stroke {\r\n            ${isDark ? 'stroke: #60a5fa;' : 'stroke: #3b82f6;'}\r\n        }\r\n        .ql-toolbar .ql-active .ql-fill {\r\n            ${isDark ? 'fill: #60a5fa;' : 'fill: #3b82f6;'}\r\n        }\r\n        \r\n        /* Collaborative cursor styles */\r\n        .ql-cursor {\r\n            position: absolute;\r\n            width: 2px;\r\n            background-color: #3b82f6;\r\n            z-index: 10;\r\n        }\r\n        .ql-cursor-name {\r\n            position: absolute;\r\n            top: -20px;\r\n            left: 0;\r\n            background-color: #3b82f6;\r\n            color: white;\r\n            padding: 2px 6px;\r\n            border-radius: 4px;\r\n            font-size: 12px;\r\n            white-space: nowrap;\r\n            z-index: 11;\r\n        }\r\n        \r\n        /* Selection highlight for other users */\r\n        .ql-selection {\r\n            background-color: rgba(59, 130, 246, 0.2);\r\n            position: absolute;\r\n            z-index: 5;\r\n        }\r\n        /* Overlay container */\r\n        .ql-remote-overlays {\r\n            position: relative;\r\n        }\r\n    `;\r\n\r\n    const modules = {\r\n        toolbar: [\r\n            [{ 'header': [1, 2, 3, false] }],\r\n            ['bold', 'italic', 'underline', 'strike'],\r\n            [{ 'color': [] }, { 'background': [] }],\r\n            [{ 'list': 'ordered' }, { 'list': 'bullet' }],\r\n            [{ 'indent': '-1' }, { 'indent': '+1' }],\r\n            [{ 'align': [] }],\r\n            ['link', 'blockquote', 'code-block'],\r\n            ['clean']\r\n        ]\r\n    };\r\n\r\n    const formats = [\r\n        'header', 'bold', 'italic', 'underline', 'strike',\r\n        'color', 'background', 'list', 'bullet', 'indent',\r\n        'align', 'link', 'blockquote', 'code-block'\r\n    ];\r\n\r\n    return (\r\n        <>\r\n            <style>{customStyles}</style>\r\n            <div className={`${isDark ? 'bg-gray-800' : 'bg-white'} rounded-lg border ${isDark ? 'border-gray-700' : 'border-gray-200'} shadow-sm`}>\r\n                <div className=\"ql-remote-overlays\" style={{ position: 'relative' }}>\r\n                    <ReactQuill\r\n                        ref={quillRef}\r\n                        theme=\"snow\"\r\n                        value={value}\r\n                        onChange={handleChange}\r\n                        onChangeSelection={handleSelectionChange}\r\n                        modules={isReadOnly ? { toolbar: false } : modules}\r\n                        formats={formats}\r\n                        readOnly={isReadOnly}\r\n                        placeholder={isReadOnly ? \"This document is read-only\" : \"Start typing your document...\"}\r\n                    />\r\n\r\n                    {/* Remote selections & cursors */}\r\n                    {quillRef.current && remoteSelections && remoteSelections.map((sel) => {\r\n                        try {\r\n                            const quill = quillRef.current.getEditor();\r\n                            const bounds = quill.getBounds(sel.index, sel.length || 0);\r\n                            const container = quill.getBounds(0, quill.getLength());\r\n                            if (!bounds) return null;\r\n\r\n                            const cursorStyle = {\r\n                                position: 'absolute',\r\n                                left: `${bounds.left}px`,\r\n                                top: `${bounds.top}px`,\r\n                                height: `${bounds.height || 18}px`,\r\n                                width: '2px',\r\n                                backgroundColor: sel.color,\r\n                                zIndex: 10,\r\n                            };\r\n\r\n                            const nameStyle = {\r\n                                position: 'absolute',\r\n                                left: `${bounds.left}px`,\r\n                                top: `${Math.max(bounds.top - 20, 0)}px`,\r\n                                backgroundColor: sel.color,\r\n                                color: '#fff',\r\n                                padding: '2px 6px',\r\n                                borderRadius: '4px',\r\n                                fontSize: '12px',\r\n                                whiteSpace: 'nowrap',\r\n                                zIndex: 11,\r\n                            };\r\n\r\n                            const selectionStyle = sel.length > 0 ? {\r\n                                position: 'absolute',\r\n                                left: `${bounds.left}px`,\r\n                                top: `${bounds.top}px`,\r\n                                width: `${bounds.width || 2}px`,\r\n                                height: `${bounds.height || 18}px`,\r\n                                backgroundColor: `${sel.color}33`, // ~20% opacity\r\n                                zIndex: 5,\r\n                            } : null;\r\n\r\n                            return (\r\n                                <div key={sel.userId}>\r\n                                    {selectionStyle && <div style={selectionStyle} />}\r\n                                    <div style={cursorStyle} />\r\n                                    <div style={nameStyle}>{sel.name || 'User'}</div>\r\n                                </div>\r\n                            );\r\n                        } catch (e) {\r\n                            return null;\r\n                        }\r\n                    })}\r\n                </div>\r\n            </div>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default CollaborativeTextElement;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}